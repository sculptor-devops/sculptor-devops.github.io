<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="Sculptor devops advance installer">

        <meta property="og:site_name" content="Sculptor"/>
        <meta property="og:title" content="Advance Installer | Sculptor"/>
        <meta property="og:description" content="Sculptor devops advance installer"/>
        <meta property="og:url" content="https://sculptor-devops.github.io/docs/advanced/installer"/>
        <meta property="og:image" content="/assets/img/logo.png"/>
        <meta property="og:type" content="website"/>

        <meta name="twitter:image:alt" content="Sculptor">
        <meta name="twitter:card" content="summary_large_image">

                    <meta name="generator" content="tighten_jigsaw_doc">
        
        <title>Sculptor | Advance Installer</title>

        <link rel="home" href="https://sculptor-devops.github.io">
        <link rel="icon" href="/favicon.ico">

        
                    <!-- Insert analytics code here -->
        
        <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i,800,800i" rel="stylesheet">
        <link rel="stylesheet" href="/assets/build/css/main.css?id=7fe2e30993ee19759025">

        <link rel="stylesheet" href="/assets/cast/asciinema-player.css" rel="stylesheet">

                    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
            </head>

    <body class="flex flex-col justify-between min-h-screen bg-gray-100 text-gray-800 leading-normal font-sans">
        <header class="flex items-center bg-white border-b h-24 mb-8  xl:mb-0 lg:mb-0 py-4" role="banner">
            <div class="container flex items-center max-w-8xl mx-auto px-4 lg:px-8">
                <div class="flex items-center">
                    <a href="/" title="Sculptor home" class="inline-flex items-center">
					    <img class="h-8 md:h-10 mr-3" src="/assets/img/logo-large.svg" alt="Sculptor logo" />											
	                    <h1 class="text-lg md:text-2xl text-blue-900 font-semibold hover:text-blue-600 my-0 pr-4">Sculptor</h1>
                    </a>
                </div>

                <div class="flex flex-1 justify-end items-center text-right md:pl-10">				
                                            <button
    title="Start searching"
    type="button"
    class="flex md:hidden bg-gray-100 hover:bg-blue-100 justify-center items-center border border-gray-500 rounded-full focus:outline-none h-10 px-3"
    onclick="searchInput.toggle()"
>
    <img src="/assets/img/magnifying-glass.svg" alt="search icon" class="h-4 w-4 max-w-none">
</button>

<div id="js-search-input" class="docsearch-input__wrapper hidden md:block">
    <label for="search" class="hidden">Search</label>

    <input
        id="docsearch-input"
        class="docsearch-input relative block h-10 transition-fast w-full lg:w-1/2 xl:w-1/3 bg-gray-100 outline-none rounded-full text-gray-700 border border-gray-500 focus:border-blue-400 ml-auto px-4 pb-0"
        name="docsearch"
        type="text"
        placeholder="Search"
    >

    <button
        class="md:hidden absolute pin-t pin-r h-full font-light text-3xl text-blue-500 hover:text-blue-600 focus:outline-none -mt-px pr-7"
        onclick="searchInput.toggle()"
    >&times;</button>
</div>

                                    </div>
                <div class="ml-2 mt-1">
                    <a href="https://github.com/sculptor-devops" target="_blank">
                        <i class="fab fa-github fa-2x"></i>
                    </a>
                </div>
            </div>

                <button class="flex justify-center items-center bg-blue-500 border border-blue-500 h-10 mr-4 px-5 rounded-full lg:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current text-white h-9 w-4" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current text-white h-9 w-4" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

        </header>

        <main role="main" class="w-full flex-auto bg-main">
            <section class="container max-w-8xl mx-auto px-6 md:px-8 py-4">
    <div class="flex flex-col lg:flex-row">
        <nav id="js-nav-menu" class="nav-menu hidden lg:block">
            <ul class="my-0">
                <li class="pl-4">
                    <a href="https://github.com/sculptor-devops" target="_blank" class="nav-menu__item">
                                <i class="fab fa-github fa"></i> GitHub
                    </a>
                </li>        
            </ul>
            <ul class="my-0">
            <li class="pl-4">
            
        <a href="/docs/getting-started"
            class="border p-2 mb-4 rounded-md bg-blue-300 lvl0   nav-menu__item hover:text-blue-400"
        >
            Getting Started
        </a>
    
            
        <ul class="my-0">
            <li class="pl-4">
            
        <a href="/docs/introduction"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Introduction
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/getting-started"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Installation
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/getting-started/create-domain"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Create a domain
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/getting-started/moving-forward"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Move forward
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/getting-started/troubleshooting"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Troubleshooting
        </a>
    
    </li>
    </ul>
    </li>
            <li class="pl-4">
            
        <a href="/docs/repository"
            class="border p-2 mb-4 rounded-md bg-blue-300 lvl0   nav-menu__item hover:text-blue-400"
        >
            Deploy
        </a>
    
            
        <ul class="my-0">
            <li class="pl-4">
            
        <a href="/docs/repository"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Repository
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/webhooks"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Webhooks
        </a>
    
    </li>
    </ul>
    </li>
            <li class="pl-4">
            
        <a href="/docs/commands/domains"
            class="border p-2 mb-4 rounded-md bg-blue-300 lvl0   nav-menu__item hover:text-blue-400"
        >
            Commands
        </a>
    
            
        <ul class="my-0">
            <li class="pl-4">
            
        <a href="/docs/commands/domains"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Domains
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/commands/deploy"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Deploy
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/commands/databases"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Databases
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/commands/backups"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Backups
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/commands/alarms"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Alarms
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/commands/system"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            System
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/upgrade"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Upgrade
        </a>
    
    </li>
    </ul>
    </li>
            <li class="pl-4">
            
        <a href="/docs/platform/compatibility"
            class="border p-2 mb-4 rounded-md bg-blue-300 lvl0   nav-menu__item hover:text-blue-400"
        >
            Platform
        </a>
    
            
        <ul class="my-0">
            <li class="pl-4">
            
        <a href="/docs/platform/compatibility"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Compatibility
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/platform/software"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Software
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/platform/security"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Security
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/roadmap"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Roadmap
        </a>
    
    </li>
    </ul>
    </li>
            <li class="pl-4">
            
        <a href="/docs/advanced/installer"
            class="border p-2 mb-4 rounded-md bg-blue-300 lvl0 lvl0-active active font-semibold text-blue-800 nav-menu__item hover:text-blue-400"
        >
            Advanced
        </a>
    
            
        <ul class="my-0">
            <li class="pl-4">
            
        <a href="/docs/advanced/installer"
            class=" lvl1  active font-semibold text-blue-800 nav-menu__item hover:text-blue-400"
        >
            Installer
        </a>
    
    </li>
    </ul>
    </li>
            <li class="pl-4">
            
        <a href="/docs/about"
            class="border p-2 mb-4 rounded-md bg-blue-300 lvl0   nav-menu__item hover:text-blue-400"
        >
            About
        </a>
    
            
        <ul class="my-0">
            <li class="pl-4">
            
        <a href="/docs/contribute"
            class=" lvl1   nav-menu__item hover:text-blue-400"
        >
            Contribute
        </a>
    
    </li>
    </ul>
    </li>
    </ul>
        </nav>

        <div class="DocSearch-content w-full lg:w-3/5 break-words pb-16 lg:pl-4" v-pre>
            <h1>Installer</h1>

<p>The installer is not meant to be used for Sculptor only, you can customize and skip certaint steps. Installation is done by stage, you can see available with the command below.</p>

<pre><code class="language-shell">./installer list-stages

Running on OS Version 18.04
You can see detailed log in /root/installer.log
Every step can take several minutes
+------+----------------+
| Step | Name           |
+------+----------------+
| 1    | Credentials    |
| 2    | Superuser      |
| 3    | Motd           |
| 4    | Ntp            |
| 5    | Php Cgi        |
| 6    | Base Packages  |
| 7    | SSH Daemon     |
| 8    | NodeJs         |
| 9    | Nginx          |
| 10   | MySql Server   |
| 11   | Redis Server   |
| 12   | Let's Encrypt  |
| 13   | Composer       |
| 14   | Deployer       |
| 15   | Firewall       |
| 16   | Crontab        |
| 17   | Check services |
| 18   | Agent          |
+------+----------------+
</code></pre>

<h2>Run only one stage</h2>

<p>You can specify a signle step to be run directly from the command line, you need only to specify wich step. Remember to quote the step that is as you can see in the list stages and is case isensitive.</p>

<pre><code class="language-shell">./installer run-stage --step="credentials"

Running on OS Version 18.04
You can see detailed log in /root/installer.log
Every step can take several minutes
Running credentials: ✔
Run time taken 00:00:00
+-------------------+------------------------------+
| name              | value                        |
+-------------------+------------------------------+
| Public IP         | [AN IP]                      |
| Password          | [A PASSWORD]                 |
| Database Password | [A DB PASSWORD]              |
+-------------------+------------------------------+
</code></pre>

<h2>Customized stages</h2>

<p>You can create a custom stage list creating a yml with the desidered stages. For example if you want to install a Nginx/Mysql machine you can delete the agent installation.</p>

<blockquote>
  <p><strong>Warning</strong>
  All steps need to be run after credential steps that prepare the env, do not remove. The MySql and Agent step cannot be run twice if already installed, you need to purge > installation and the content. Alternatively the Agent can run twice only if you set the password and db password with the current already in use (see section below).</p>
</blockquote>

<pre><code class="language-shell">./installer config
Writing customizable /root/sculptor/installer.yml
</code></pre>

<p>Here the example file.</p>

<pre><code class="language-yml">stages:
  - Credentials # Mandatory do not remove
  - SuUser
  - Motd
  - Ntp
  - Php
  - Packages
  - Sshd
  - NodeJs
  - Nginx
  - MySql
  - Redis
  - LetsSEncrypt
  - Composer
  - Deployer
  - Firewall
  - Crontab
  - CheckServices
  - Agent
</code></pre>

<p>You can additionally dump configuration stubs also, so you cand specify certain options forn nginx or other services; all date will be put in custom_templates folder.</p>

<pre><code class="language-shell">./installer config --templates 
Customized configuration already exists /root/sculptor/installer.yml
Writing template /root/sculptor/custom_templates/agent-deploy.php
Writing template /root/sculptor/custom_templates/agent-env
Writing template /root/sculptor/custom_templates/env
Writing template /root/sculptor/custom_templates/file2ban.conf
Writing template /root/sculptor/custom_templates/index.html
Writing template /root/sculptor/custom_templates/motd
Writing template /root/sculptor/custom_templates/nginx.conf
Writing template /root/sculptor/custom_templates/ntp.conf
Writing template /root/sculptor/custom_templates/panel.crontab
Writing template /root/sculptor/custom_templates/php-pool.conf
Writing template /root/sculptor/custom_templates/php.ini
Writing template /root/sculptor/custom_templates/sshd.conf
Writing template /root/sculptor/custom_templates/sudoer.conf
Writing template /root/sculptor/custom_templates/system.scupltor.conf
</code></pre>

<p>Note: if one ore more files are already present will not be overweitter.</p>

<h2>Customize versions</h2>

<p>You can modify the node version, installed globally and php versions as follows.</p>

<pre><code class="language-yml">stages:
# PHP Versions
php_versions:
  # - 5.6
  # - 7.0
  # - 7.1
  # - 7.2
  # - 7.3
  # - 7.4
  # - 8.0
  # - 8.1  

# NodeJs Version
node_version: 14
</code></pre>

<h2>Customize other parameters</h2>

<p>Sometime you need to run installer more times but remember that agent and mysql can run only once; in this case you can customize password to keep the same as the first installer run so installation will remain the same.</p>

<pre><code class="language-yml">db_password: database_password
password: sudo_user_password
</code></pre>

<h2>Summary</h2>

<table>
<thead>
<tr>
  <th>Command</th>
  <th>Parameter</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong><em>list-stages</em></strong></td>
  <td>None</td>
  <td>List all stages</td>
</tr>
<tr>
  <td><strong><em>run</em></strong></td>
  <td>None</td>
  <td>Start a new installation</td>
</tr>
<tr>
  <td><strong><em>run-stage</em></strong></td>
  <td>--step="STEP NAME"</td>
  <td>Run a single step, see list for names</td>
</tr>
<tr>
  <td><strong><em>config</em></strong></td>
  <td>--templates</td>
  <td>Create a customizable installation.yml, with --templates will create a folder with all templates that can be customized.</td>
</tr>
</tbody>
</table>
        </div>
    </div>
</section>
        </main>

        <script src="/assets/build/js/main.js?id=f01f0dd8648e081bd0a1"></script>
        <script src="/assets/cast/asciinema-player.js"></script>

        <script>
    const navMenu = {
        toggle() {
            const menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
        },
    }
</script>
            <script type="text/javascript">
            docsearch({
                apiKey: 'bfe2f70b574268a443312bd71480f20c',
                indexName: 'sculptor-devops',
                inputSelector: '#docsearch-input',
                debug: false // Set debug to true if you want to inspect the dropdown
            });

            const searchInput = {
                toggle() {
                    const menu = document.getElementById('js-search-input');
                    menu.classList.toggle('hidden');
                    menu.classList.toggle('md:block');
                    document.getElementById('docsearch-input').focus();
                },
            }
        </script>
    
        <footer class="bg-white text-center text-sm mt-12 py-4" role="contentinfo">
            <ul class="flex flex-col md:flex-row justify-center">
                <li class="md:mr-2">
                    idea by <a href="https://cappellozza.com" title="Alessandro Cappellozza">Alessandro Cappellozza</a> &copy; 2021.
                </li>

                <li class="md:mr-2">
                    See <a href="/docs/about/" title="Alessandro Cappellozza">About</a> for more informations
                </li>
            </ul>
        </footer>
    </body>
</html>
